{% extends 'base.html' %}
{% load crispy_forms_tags %}
{% load i18n %}

{% block content %}

<nav style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/">{% trans 'Inicio' %}</a></li>
        <li class="breadcrumb-item"><a href="{% url 'programs' %}">{% trans 'Programas' %}</a></li>
        <li class="breadcrumb-item"><a href="{% url 'program_detail' course.program.id %}">{{ course.program }}</a></li>
        <li class="breadcrumb-item"><a href="{{ course.get_absolute_url }}">{{ course }}</a></li>
        <li class="breadcrumb-item"><a href="{% url 'quiz_index' course.slug %}">{% trans 'Cuestionarios' %}</a></li>
        <li class="breadcrumb-item active" aria-current="page">{% trans 'Formulario de Cuestionario' %}</li>
    </ol>
</nav>

<div class="title-1">{% trans 'Formulario de cuestionario para' %} {{ course|truncatechars:15 }}</div>
<br><br>

<div class="container">

    <form action="" method="POST">{% csrf_token %}
        <div class="row">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-body">
                        <div hidden>
                            <label for="course">{{ form.course.label }}</label><br> {{ form.course }}
                            <span class="danger">{{ form.course.errors }}</span>
                            <span class="danger">{{ form.course.errors }}</span>
                        </div>                    
                        {{ form.category|as_crispy_field }}                    
                        {{ form.title|as_crispy_field }}
                        {{ form.pass_mark|as_crispy_field }}
                        {{ form.description|as_crispy_field }}
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card">
                    <div class="card-body">
                        <div hidden>
                            <label for="questions">{{ form.questions.label }}</label><br> {{ form.questions }}
                            <span class="danger">{{ form.questions.errors }}</span>
                            <small class="d-block text-muted">{% trans 'Mantén presionado' %} "Control", {% trans 'o' %} "Command" {% trans 'en un Mac, para seleccionar más de uno.' %}</small>
                        </div>
                        <div class="form-group mb-3">
                            {{ form.random_order|as_crispy_field }}
                        </div>
                        <div class="form-group mb-3">
                            {{ form.answers_at_end|as_crispy_field }}
                        </div>
                        <div class="form-group mb-3">
                            {{ form.exam_paper|as_crispy_field }}
                        </div>
                        <div class="form-group mb-3">
                            {{ form.single_attempt|as_crispy_field }}
                        </div>
                        <div class="form-group mb-3">
                            {{ form.draft|as_crispy_field }}
                        </div>             
                    </div>
                </div>
            </div>
        </div>
        <button class="btn btn-primary my-4" id="{% if form.is_valid %}btn-transition{% endif %}" type="submit">{% trans 'Guardar' %} &amp; {% trans 'Continuar' %}</button>
    </form>
</div>

{% endblock %}

{% block extra_css %}
<style>
    /* Asegurar que los checkboxes sean visibles y funcionen correctamente */
    .form-check-input {
        width: 1.25rem !important;
        height: 1.25rem !important;
        margin-top: 0.125rem !important;
        margin-right: 0.5rem !important;
        display: inline-block !important;
        opacity: 1 !important;
        cursor: pointer !important;
        position: relative !important;
    }
    
    .form-check-label {
        cursor: pointer !important;
        margin-left: 0 !important;
    }
    
    .form-check {
        padding-left: 0 !important;
        margin-bottom: 0.5rem !important;
    }
    
    /* Asegurar que los checkboxes de crispy forms funcionen */
    .form-group .form-check-input {
        display: inline-block !important;
        visibility: visible !important;
    }
</style>
{% endblock %}

{% block js %}
<script>
    const transitionButton = document.getElementById('btn-transition');
    if (transitionButton) {
        transitionButton.addEventListener('click', () => {
            const cardTransition = document.getElementById('card-transition');
            if (cardTransition) {
                cardTransition.style.animation = 'card-transition 5s ease-in-out forwards';
            }
        });
    }
    
    // Asegurar que los checkboxes funcionen correctamente
    document.addEventListener('DOMContentLoaded', function() {
        const checkboxes = document.querySelectorAll('input[type="checkbox"]');
        checkboxes.forEach(function(checkbox) {
            checkbox.style.display = 'inline-block';
            checkbox.style.visibility = 'visible';
            checkbox.style.opacity = '1';
            checkbox.style.position = 'relative';
        });
    });
</script>
{% endblock js %}