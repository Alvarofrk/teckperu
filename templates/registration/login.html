{% extends 'registration/registration_base.html' %}
{% load i18n %}
{% load static %}
{% block title %}{% trans 'TECK - Inicio de sesión' %}{% endblock title %}
{% load crispy_forms_tags %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/login-modern.css' %}">
{% endblock %}

{% block content %}
<div class="login-container">
  <div class="login-card">
    <div class="login-header">
      <h1 class="login-title">
        <i class="fas fa-lock me-2"></i>
        {% trans 'Ingresar' %}
      </h1>
      <p class="login-subtitle">
        {% trans 'Bienvenido a Seguridad TECK PERÚ' %}
      </p>
    </div>
    
    <div class="login-body">
      <form action="" method="POST" id="login-form">
        {% csrf_token %}
        
        {% if form.errors %}
          <div class="error-message">
            <i class="fas fa-exclamation-circle"></i>
            {% trans 'ID & Contraseña Invalidos.' %}
          </div>
        {% endif %}

        <div class="form-group">
          <label class="form-label" for="username_id">
            {% trans 'ID' %}
          </label>
          <div class="input-wrapper">
            <i class="fas fa-address-card input-icon"></i>
            <input 
              type="text" 
              name="username" 
              id="username_id" 
              class="form-control" 
              placeholder="{% trans 'Ingresa tu ID' %}"
              required
              autocomplete="username"
            >
          </div>
          <div id="message-wrapper"></div>
        </div>

        <div class="form-group">
          <label class="form-label" for="password_id">
            {% trans 'Contraseña' %}
          </label>
          <div class="input-wrapper">
            <i class="fas fa-key input-icon"></i>
            <input 
              type="password" 
              name="password" 
              id="password_id" 
              class="form-control" 
              placeholder="{% trans 'Ingresa tu contraseña' %}"
              required
              autocomplete="current-password"
            >
          </div>
        </div>

        <button type="submit" class="login-btn" id="login-btn">
          <i class="fas fa-sign-in-alt me-2"></i>
          {% trans 'INICIAR SESIÓN' %}
        </button>
      </form>

      {% comment %} 
      Sección de contraseña olvidada comentada temporalmente.
      Para reactivar, simplemente elimina las etiquetas de comentario.
      {% endcomment %}
      {% comment %}
      <div class="login-links">
        <a href="{% url 'password_reset' %}" class="login-link">
          <i class="fas fa-question-circle"></i>
          {% trans '¿Contraseña olvidada?' %}
        </a>
      </div>
      {% endcomment %}
    </div>
  </div>
</div>
{% endblock content %}

{% block js %}
<script>
  // Función para manejar el envío del formulario
  $('#login-form').submit(function (e) {
    const btn = $('#login-btn');
    const originalText = btn.html();
    
    // Agregar estado de carga
    btn.addClass('loading disabled');
    btn.html('{% trans "Iniciando sesión..." %}');
    
    // Remover estado de carga después de un tiempo (en caso de error)
    setTimeout(function() {
      if (btn.hasClass('loading')) {
        btn.removeClass('loading disabled');
        btn.html(originalText);
      }
    }, 5000);
  });

  // Mejorar UX con focus automático
  $(document).ready(function() {
    $('#username_id').focus();
    
    // Agregar efectos de hover en móviles
    if ('ontouchstart' in window) {
      $('.login-btn').on('touchstart', function() {
        $(this).addClass('active');
      }).on('touchend', function() {
        $(this).removeClass('active');
      });
    }
  });
</script>
{% endblock js %}
